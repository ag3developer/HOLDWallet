#!/usr/bin/env python3"""Script para criar tabelas no banco PostgreSQL de PRODU√á√ÉO"""import psycopg2from psycopg2 import sql# Credenciais do banco de produ√ß√£oDB_CONFIG = {    'host': 'app-1265fb66-9e7e-4f8c-b1fc-efab8c026006-do-user-22787082-0.l.db.ondigitalocean.com',    'port': 25060,    'database': 'holdwallet-db',    'user': 'holdwallet-db',    'password': 'AVNS_nUUIAsF6R5bJR3GvmRH',    'sslmode': 'require'}print("üîó Conectando ao PostgreSQL de produ√ß√£o...")print(f"   Host: {DB_CONFIG['host'][:50]}...")print(f"   Database: {DB_CONFIG['database']}")try:    conn = psycopg2.connect(**DB_CONFIG)    conn.autocommit = False    cursor = conn.cursor()        print("\n‚úÖ Conectado com sucesso!")        # SQL para criar tabelas    sqls = [        # Tabela two_factor_auth        """        CREATE TABLE IF NOT EXISTS two_factor_auth (            id UUID PRIMARY KEY DEFAULT gen_random_uuid(),            user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,            secret VARCHAR(32) NOT NULL,            is_enabled BOOLEAN DEFAULT FALSE,            is_verified BOOLEAN DEFAULT FALSE,            backup_codes TEXT,            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,            enabled_at TIMESTAMP,            last_used_at TIMESTAMP,            UNIQUE(user_id)        )        """,                # Tabela wallets        """        CREATE TABLE IF NOT EXISTS wallets (            id UUID PRIMARY KEY DEFAULT gen_random_uuid(),            user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,            name VARCHAR(100) NOT NULL,            network VARCHAR(50) NOT NULL,            derivation_path VARCHAR(100),            encrypted_seed TEXT,            seed_hash VARCHAR(64),            is_active BOOLEAN DEFAULT TRUE,            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,            updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP        )        """,                # Tabela wallet_balance        """        CREATE TABLE IF NOT EXISTS wallet_balance (            id UUID PRIMARY KEY DEFAULT gen_random_uuid(),            wallet_id UUID NOT NULL REFERENCES wallets(id) ON DELETE CASCADE,            token_symbol VARCHAR(20) NOT NULL,            token_name VARCHAR(100),            balance DECIMAL(38, 18) DEFAULT 0,            token_address VARCHAR(100),            decimals INTEGER DEFAULT 18,            last_updated TIMESTAMP DEFAULT CURRENT_TIMESTAMP,            UNIQUE(wallet_id, token_symbol, token_address)        )        """,                # √çndices        "CREATE INDEX IF NOT EXISTS idx_wallets_user_id ON wallets(user_id)",        "CREATE INDEX IF NOT EXISTS idx_wallet_balance_wallet_id ON wallet_balance(wallet_id)",        "CREATE INDEX IF NOT EXISTS idx_two_factor_auth_user_id ON two_factor_auth(user_id)",    ]        print("\nüî® Criando tabelas...")    for i, sql_stmt in enumerate(sqls, 1):        try:            cursor.execute(sql_stmt)            print(f"   ‚úÖ Statement {i} executado com sucesso")        except Exception as e:            if "already exists" in str(e).lower():                print(f"   ‚ö†Ô∏è  Statement {i}: J√° existe (OK)")            else:                print(f"   ‚ùå Statement {i} falhou: {e}")        # Commit    conn.commit()    print("\n‚úÖ Commit realizado!")        # Verificar tabelas    print("\nüìä Verificando tabelas criadas...")    cursor.execute("""        SELECT tablename         FROM pg_tables         WHERE schemaname = 'public'        ORDER BY tablename    """)        tables = cursor.fetchall()    print(f"\n   Total de tabelas: {len(tables)}")    for table in tables:        print(f"   - {table[0]}")        print("\nüéâ SUCESSO! Todas as tabelas foram criadas!")    except Exception as e:    print(f"\n‚ùå ERRO: {e}")    import traceback    traceback.print_exc()finally:    if 'cursor' in locals():        cursor.close()    if 'conn' in locals():        conn.close()        print("\nüëã Conex√£o fechada")